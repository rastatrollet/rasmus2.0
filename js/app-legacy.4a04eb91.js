(function(t){function e(e){for(var i,o,s=e[0],c=e[1],u=e[2],l=0,p=[];l<s.length;l++)o=s[l],a[o]&&p.push(a[o][0]),a[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);f&&f(e);while(p.length)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(i=!1)}i&&(r.splice(e--,1),t=c(c.s=n[0]))}return t}var i={},o={app:0},a={app:0},r=[];function s(t){return c.p+"js/"+({}[t]||t)+"-legacy."+{"chunk-4c1e":"01206284"}[t]+".js"}function c(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-4c1e":1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=new Promise(function(e,n){for(var i="css/"+({}[t]||t)+"."+{"chunk-4c1e":"d1075188"}[t]+".css",o=c.p+i,a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var s=a[r],u=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(u===i||u===o))return e()}var l=document.getElementsByTagName("style");for(r=0;r<l.length;r++){s=l[r],u=s.getAttribute("data-href");if(u===i||u===o)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var i=e&&e.target&&e.target.src||o,a=new Error("Loading CSS chunk "+t+" failed.\n("+i+")");a.request=i,n(a)},p.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(p)}).then(function(){o[t]=0}));var i=a[t];if(0!==i)if(i)e.push(i[2]);else{var r=new Promise(function(e,n){i=a[t]=[e,n]});e.push(i[2]=r);var u,l=document.getElementsByTagName("head")[0],p=document.createElement("script");p.charset="utf-8",p.timeout=120,c.nc&&p.setAttribute("nonce",c.nc),p.src=s(t),u=function(e){p.onerror=p.onload=null,clearTimeout(f);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src,r=new Error("Loading chunk "+t+" failed.\n("+i+": "+o+")");r.type=i,r.request=o,n[1](r)}a[t]=void 0}};var f=setTimeout(function(){u({type:"timeout",target:p})},12e4);p.onerror=p.onload=u,l.appendChild(p)}return Promise.all(e)},c.m=t,c.c=i,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)c.d(n,i,function(e){return t[e]}.bind(null,i));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/rasmus2.0/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var p=0;p<u.length;p++)e(u[p]);var f=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var i=n("c21b"),o=n.n(i);o.a},1436:function(t,e,n){"use strict";var i=n("3fa3"),o=n.n(i);o.a},"2ede":function(t,e,n){t.exports={tripsTable:"TripsTable_tripsTable_seMaN",showingJourneyDetails:"TripsTable_showingJourneyDetails_2vlip",table:"TripsTable_table_2aCjV",tableHead:"TripsTable_tableHead_35rh1",trip:"TripsTable_trip_3L8k2",tripLine:"TripsTable_tripLine_1UetD",cancelled:"TripsTable_cancelled_2B1S9",tripName:"TripsTable_tripName_1S77x",tripTime:"TripsTable_tripTime_MCuJO",tripNewTime:"TripsTable_tripNewTime_1TU8j",isLate:"TripsTable_isLate_332Tg",tripTrack:"TripsTable_tripTrack_hi4oT",VT:"TripsTable_VT_zu_SE",TV:"TripsTable_TV_1mpPl",SL:"TripsTable_SL_1kF6p"}},"2f3b":function(t,e,n){"use strict";var i=n("b679"),o=n.n(i);e["default"]=o.a},"3fa3":function(t,e,n){},"452a":function(t,e,n){"use strict";var i=n("9ec4"),o=n.n(i);o.a},"55a3":function(t,e,n){"use strict";var i=n("2ede"),o=n.n(i);e["default"]=o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d"),n("2dd2");var i,o,a=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"top-nav"},[n("Tabs",{attrs:{tabs:t.tabs,"on-click":t.changeTab,"current-tab":t.currentTab}}),n("DigitalClock")],1),n("div",{staticClass:"container"},[n(t.currentTabComponent.componentName,t._b({tag:"component"},"component",t.currentTabComponent.props,!1))],1)])},s=[],c=(n("7514"),n("8afe")),u=(n("7f7f"),n("c93e")),l=n("2f62"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{class:t.$style.informationPage},[t.isLoading?n("font-awesome",{class:t.$style.spinner,attrs:{icon:"spinner",spin:""}}):t._e(),n("div",{attrs:{id:t.gdocElementId}}),n("a",{class:t.$style.editLink,attrs:{href:t.editLink}},[t._v("Redigera")])],1)},f=[],d=(n("96cf"),n("4917"),n("a481"),n("28a5"),n("3040")),m="499673240843-8f8bn77590948esm040d5cl5s4k32hkq.apps.googleusercontent.com",h="AIzaSyAQVyCYvuXOxLcIMlT68G-ELLSxMVDqDGc",v=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],g=["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.metadata.readonly"].join(" "),b={Datum:"date","Hållplats":"origin",Linje:"sname",Namn:"direction",Tid:"time","Ny tid":"rtTime","Läge":"track",Bakgrund:"fgColor"},y={infoDoc:{fileId:"1TRE1P4EmB3kwlURit8lICniBtRp7aqnhcU8x7D6yzqI",mimeType:"text/html"},manualDepartures:{fileId:"1XSzg87FgHsxUl6UqNfRJtYIkw8wyN0yB3RzIib3JsvM",mimeType:"text/tab-separated-values"}},T=!1;function _(){return L.apply(this,arguments)}function L(){return L=Object(d["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!T){t.next=2;break}return t.abrupt("return");case 2:e=document.createElement("script"),e.addEventListener("load",function(){T=!0,gapi.load("client:auth2",D)}),e.src="https://apis.google.com/js/api.js",document.body.appendChild(e);case 6:case"end":return t.stop()}},t,this)})),L.apply(this,arguments)}var S=new Promise(function(t,e){i=t,o=e}).then(function(){if(gapi.auth2.getAuthInstance().isSignedIn.get())return gapi.auth2.getAuthInstance().signIn()});function D(){gapi.client.init({apiKey:h,clientId:m,discoveryDocs:v,scope:g}).then(i).catch(o)}function k(t){return S.then(function(){return j(y.infoDoc).then(function(e){return O(e,t)}).catch(function(t){return console.error(t)})})}function w(){return S.then(function(){return j(y.manualDepartures).then(function(t){var e=t.body;return e}).then(function(t){var e=t.split(/\n/),n=e[0].replace(/\n|\r/g,"").split(/\t/);return e.slice(1).map(function(t){var e=t.split(/\t/);return n.reduce(function(t,n,i){var o=b[n]||n;return t[o]=e[i],t},{})})})})}function j(t){return gapi.client.drive.files.export(t)}function O(t,e){var n=t.body.match(/<body[^>]*>(.*)<\/body><\/html>$/)[1],i=document.getElementById(e);i.innerHTML=n}var I={init:_,printInfoDoc:k,getManualDepartures:w},A="https://docs.google.com/document/d/1TRE1P4EmB3kwlURit8lICniBtRp7aqnhcU8x7D6yzqI/edit#",C={name:"InformationPage",data:function(){return{isLoading:!0,gdocElementId:"gdoc",editLink:A}},mounted:function(){var t=this;I.init(),I.printInfoDoc(this.gdocElementId).then(function(){return t.isLoading=!1}).catch(function(){return t.isLoading=!1})}},E=C,N=n("979c"),x=n("2877");function $(t){this["$style"]=N["default"].locals||N["default"]}var J=Object(x["a"])(E,p,f,!1,$,null,null);J.options.__file="InformationPage.vue";var R=J.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"digital-clock"},[t._v("\n  "+t._s(t.hours)+":"+t._s(t.minutes)+":"+t._s(t.seconds)+"\n")])},P=[];n("f576");function M(t,e,n){var i;return n=n||this,function(){for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];i&&clearTimeout(i),i=setTimeout(function(){return t.apply(n,a)},e)}}function B(t){return"none"!==window.getComputedStyle(t).display}var U={name:"DigitalClock",data:function(){return{intervalId:null,hours:"",minutes:"",seconds:""}},created:function(){this.handleResize=M(this.handleResize,250)},mounted:function(){this.updateDateTime(),this.startInterval(),this.handleResize(),window.addEventListener("resize",this.handleResize,!1)},beforeDestroy:function(){this.stopInterval(),window.removeEventListener("resize",this.handleResize,!1)},methods:{handleResize:function(){B(this.$el)?this.startInterval():this.stopInterval()},startInterval:function(){this.stopInterval(),this.intervalId=setInterval(this.updateDateTime,1e3)},stopInterval:function(){clearInterval(this.intervalId)},updateDateTime:function(){var t=new Date;this.hours=String(t.getHours()).padStart(2,"0"),this.minutes=String(t.getMinutes()).padStart(2,"0"),this.seconds=String(t.getSeconds()).padStart(2,"0")}}},z=U,V=(n("1436"),Object(x["a"])(z,F,P,!1,null,null,null));V.options.__file="DigitalClock.vue";var H=V.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{class:t.$style.stationInfo},[n("div",{class:t.$style.form},[n("LocationInput",{attrs:{disabled:t.initializing,label:"Hållplats"}})],1),t.location?n("TripsFilter",{attrs:{dict:t.dict}}):t._e(),n("div",{class:t.$style.content},[n("TripsTable",{attrs:{"from-to-label":t.fromToLabel}}),n("JourneyDetails")],1),t.location?n("footer",{class:t.$style.situations},[t._l(t.situations.messages,function(e,i){return n("p",{key:i},[t._v(t._s(e))])}),0===t.situations.messages.length?n("p",[t._v("Inga trafikstörningar.")]):t._e()],2):t._e()],1)},G=[],Q=(n("ac6a"),n("f751"),'<LOGIN authenticationkey="2dfa6ea579bd45e3ac3810eb1a97adb6" />'),K={},Y={TrainStation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.lat,n=t.long,i=t.name,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return i?'\n        <FILTER>\n          <AND>\n            <LIKE name="AdvertisedLocationName" value="/^'.concat(i,'/" />\n            <EQ name="Advertised" value="true" />\n          </AND>\n        </FILTER>\n      '):e&&n?'\n        <FILTER>\n          <AND>\n            <WITHIN name="Geometry.WGS84" shape="center" value="'.concat(n," ").concat(e,'" radius="').concat(o,'m" />\n            <EQ name="Advertised" value="true" />\n          </AND>\n        </FILTER>\n      '):"<FILTER />"},TrainMessage:function(t){return'\n      <FILTER>\n        <EQ name="AffectedLocation" value="'.concat(t,'" />\n      </FILTER>\n    ')},TrainAnnouncement:function(t){return'\n      <FILTER>\n        <AND>\n          <EQ name="Advertised" value="true" />\n          <EQ name="ActivityType" value="Avgang" />\n          <EQ name="LocationSignature" value="'.concat(t,'" />\n          <GT name="AdvertisedTimeAtLocation" value="$dateadd(00:00:00)" />\n          <LT name="AdvertisedTimeAtLocation" value="$dateadd(05:00:00)" />\n        </AND>\n      </FILTER>\n    ')}};function X(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return fetch("https://api.trafikinfo.trafikverket.se/v1.3/data.json",{body:"\n      <REQUEST>\n        ".concat(Q,'\n        <QUERY objecttype="').concat(t,'" ').concat("TrainAnnouncement"===t?'orderby="AdvertisedTimeAtLocation"':"",">\n          ").concat(Y[t].apply(Y,n),"\n        </QUERY>\n      </REQUEST>\n    "),method:"POST",mode:"cors",headers:{"Content-Type":"text/xml"}}).then(function(t){var e=t.json().then(function(t){return t.RESPONSE.RESULT});return t.ok?e:e.then(function(t){return Promise.reject(t)})}).then(function(e){return e[0][t]||[]}).catch(function(t){return console.error(t)})}function W(t){return console.log(t||"No results"),t}function Z(t){return Object.assign({},t,{name:t.AdvertisedLocationName,id:t.LocationSignature,region:"TV"})}function tt(t){var e=t.lat,n=t.lng;return X("TrainStation",{lat:e,long:n},5e3).then(function(t){return t.slice(0,5).map(Z)})}var et,nt,it={init:function(){return X("TrainStation").then(function(t){return t.forEach(function(t){K[t.LocationSignature]=t.AdvertisedLocationName})})},getClosestStops:tt,getClosestStop:function(t){return tt(t).then(function(t){return t[0]})},getTrafficSituations:function(t){return X("TrainMessage",t).then(W).then(function(t){return{messages:t.map(function(t){var e=t.ExternalDescription;return e})}})},getDeparturesFrom:function(t){return X("TrainAnnouncement",t).then(function(t){return(t||[]).slice(0,30)}).then(W).then(function(t){return t.map(function(t){return Object(u["a"])({},t,{id:t.ActivityId,direction:t.ToLocation&&(K[t.ToLocation[0].LocationName]||""),via:t.ViaToLocation&&(K[t.ViaToLocation[0].LocationName]||""),name:"".concat(t.ProductInformation.join(" ")),time:t.AdvertisedTimeAtLocation.substr(-8,5),timestamp:new Date(t.AdvertisedTimeAtLocation).getTime(),isLate:!1,track:t.TrackAtLocation,sname:t.ProductInformation[0]})})})},findStops:function(t){return X("TrainStation",{name:t}).then(function(t){return t.slice(0,15).map(Z)})},stationMap:K},ot=(n("20d6"),"https://api.vasttrafik.se/bin/rest.exe/v2"),at="https://api.vasttrafik.se/ts/v1/traffic-situations";function rt(t,e){var n=e?"".concat(at,"/").concat(e,"/").concat(t):at;return vt(n,{Accept:"application/json"}).then(function(t){return t.reduce(function(t,e){var n=e.title,i=e.description,o=e.affectedLines;return{messages:t.messages.concat("".concat(n," ").concat(i)),affectedLines:[].concat(t.affectedLines,o.map(function(t){var e=t.designation;return e})).filter(function(t){return t})}},{messages:[]})})}function st(t,e){var n=new Date,i=n.toISOString().substr(0,10),o=n.toLocaleTimeString().substr(0,5),a="".concat(ot,"/trip?originId=").concat(t,"&destId=").concat(e,"&date=").concat(i,"&time=").concat(o,"&format=json");return vt(a).then(function(t){return Tt(t.TripList.Trip).map(function(t){return Tt(t.Leg)})})}function ct(t){var e="".concat(ot,"/location.name?input=").concat(encodeURIComponent(t),"&format=json");return vt(e).then(function(t){return Tt(t.LocationList.StopLocation).slice(0,5)}).then(function(t){return t.map(function(t){return Object.assign({},t,{region:"VT"})})})}function ut(t){return t.map(function(t){var e=t.rtTime&&t.rtTime!==t.time,n=t.rtTime||t.time,i=t.rtDate||t.date,o=new Date("".concat(i,"T").concat(n)).getTime();return Object.assign({},t,{region:"VT",cancelled:Boolean(t.cancelled),isLate:e,timestamp:o})})}function lt(t,e){var n=new Date,i=n.toISOString().substr(0,10),o=n.toLocaleTimeString().substr(0,5),a="".concat(ot,"/arrivalBoard?id=").concat(encodeURIComponent(t),"&date=").concat(encodeURIComponent(i),"&time=").concat(encodeURIComponent(o),"&format=json");return e&&(a="".concat(a,"&timeSpan=").concat(e)),ft(t,a).then(function(t){return t.ArrivalBoard.Arrival}).then(ut)}function pt(t,e){var n="".concat(ot,"/departureBoard?id=").concat(encodeURIComponent(t),"&format=json");return e&&(n="".concat(n,"&timeSpan=").concat(e)),ft(t,n).then(function(t){return t.DepartureBoard.Departure||[]}).then(ut)}function ft(t,e){return vt(e).then(function(t){var e=t.error,n=t.errorText;return(e||n)&&console.error("[getTimeTable]",e||n),t})}function dt(t){var e=t.south,n=t.west,i=t.north,o=t.east,a=function(t){return Math.round(1e6*t)},r="".concat(ot,"/livemap?minx=").concat(a(n),"&miny=").concat(a(e),"&maxx=").concat(a(o),"&maxy=").concat(a(i),"&onlyRealtime=yes");return vt(r).then(function(t){var e=t.livemap;return e.vehicles})}function mt(t){return vt(t).then(function(t){var e=t.JourneyDetail;return e})}function ht(t){return vt(t).then(function(t){var e=t.Geometry;return e})}function vt(t,e){var n=Promise.resolve(),i=Object(u["a"])({},e,{Authorization:"Bearer ".concat(et)});return(!nt||nt.getTime()<Date.now())&&(console.log("Need to update authtoken"),n.then(bt)),n.then(function(){return fetch(t,{headers:i})}).then(yt)}function gt(t){var e=t.lat,n=t.lng,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a="".concat(ot,"/location.nearbystops?originCoordLat=").concat(e,"&originCoordLong=").concat(n,"&maxNo=").concat(2*i,"&format=json");return vt(a).then(function(t){if(t.LocationList.errorText)throw new Error(t.LocationList.errorText);return t.LocationList.StopLocation?t.LocationList.StopLocation.filter(function(t,e,n){var i=t.name,o=n.findIndex(function(t){return t.name===i});return o===e}).map(function(t){return Object(u["a"])({},t,{region:"VT"})}).slice(0,i):[]}).catch(function(t){if(!o)throw console.error("[getClosestStops]",t),t;console.error("[getClosestStops]:",t,"retrying"),gt({lat:e,lng:n},i,!1)})}function bt(){return fetch("https://api.vasttrafik.se:443/token",{headers:{Authorization:"Basic b1pZclV2c1ZGTG8zZ2FSemNaS0NUbEdJX21ZYTo4bTlLNnFsaDVNQXBWRFdRYlVWSUhneWZja3dh","Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:"grant_type=client_credentials"}).then(yt).then(function(t){return et=t.access_token,nt=new Date(Date.now()+1e3*t.expires_in),console.log("AuthToken expires ".concat(nt.toLocaleString())),t.access_token})}function yt(t){return t.ok?t.json():t.json().then(function(t){return Promise.reject(t)})}function Tt(t){return t?[].concat(t):[]}var _t=bt();function Lt(){return _t}var St={init:Lt,getClosestStop:function(t){return gt(t,1)},getClosestStops:gt,findStops:ct,getGeometry:ht,getJourneyDetail:mt,getTripSuggestion:st,getDeparturesFrom:pt,getArrivalsTo:lt,getTrafficSituations:rt,getLiveMap:dt,transformTrips:ut},Dt=(n("1c4c"),"http://api.sl.se/api2"),kt={method:"GET"},wt={7:"gray",10:"#1C7F2A",11:"#1C7F2A",12:"gray",13:"#D51427",14:"#D51427",17:"#60A42B",18:"#60A42B",19:"#60A42B",21:"brown",22:"orange",25:"turquoise",26:"turquoise",27:"purple",28:"purple",29:"purple",40:"pink",41:"pink",42:"pink",43:"pink",44:"pink",45:"pink",48:"pink"};function jt(t){return wt[t]||"#A4A5A7"}function Ot(t){return Object(u["a"])({},t,{HafasId:t.id,id:t.id.substr(-4),region:"SL"})}function It(t){var e=t.lat,n=t.lng,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,o="bf8e1f49392843a19e86ef1ccbaa15a0",a="nearbystops.json?key=".concat(o,"&originCoordLat=").concat(e,"&originCoordLong=").concat(n,"&maxresults=").concat(i);return Ft(a).then(function(t){var e=Array.from(t.LocationList.StopLocation);return e.map(Ot)})}function At(t){return It(t,1)[0]}function Ct(t){var e="76ea4bd8c1014b6490418de04bfd0b32",n="typeahead.json?key=".concat(e,"&searchstring=").concat(encodeURIComponent(t),"&maxresults=5");return Ft(n).then(function(t){return Rt(t.ResponseData)}).then(function(t){return t.filter(function(e,n){var i=t.findIndex(function(t){var n=t.SiteId;return n===e.SiteId});return i>=n}).slice(0,5).map(function(t){return Object(u["a"])({},t,{name:t.Name,id:t.SiteId,region:"SL"})})})}var Et={BUS:"Buss",METRO:"T-bana",SHIP:"Båt",TRAIN:"Tåg",TRAM:"Spårvagn"};function Nt(t){return Et[t]||t}function xt(t){var e="a312919085a9447d839109b9a6880d20",n="realtimedeparturesV4.json?key=".concat(e,"&siteid=").concat(t,"&timewindow=30");return Ft(n).then(function(t){return Object(c["a"])(t.ResponseData.Buses).concat(Object(c["a"])(t.ResponseData.Metros),Object(c["a"])(t.ResponseData.Ships),Object(c["a"])(t.ResponseData.Trains),Object(c["a"])(t.ResponseData.Trams)).map(function(t){return Object(u["a"])({},t,{fgColor:jt(t.LineNumber),bgColor:"white",direction:t.Destination,timestamp:new Date(t.ExpectedDateTime||t.TimeTabledDateTime).getTime(),time:t.TimeTabledDateTime.substr(11,5),rtTime:t.ExpectedDateTime.substr(11,5),name:"".concat(Nt(t.TransportMode)," ").concat(t.LineNumber),sname:t.LineNumber,track:t.StopPointDesignation||t.JourneyDirection,region:"SL",href:"#",isLate:t.TimeTabledDateTime!==t.ExpectedDateTime})})})}function $t(t){var e="367eaa6107874c6e86bd985872f9cd46",n="deviations.json?key=".concat(e,"&siteId=").concat(t);return Ft(n).then(function(t){return Rt(t.ResponseData)}).then(function(t){return{messages:t.map(function(t){var e=t.Details;return e})}})}function Jt(t){return t.ok&&204!==t.status?t.json():t.ok?(console.log("fetchMiddleware: not json and no error"),t):t.json().then(function(t){return Promise.reject(t)})}function Rt(t){return t&&[].concat(t)||[]}function Ft(t){var e="".concat(Dt,"/").concat(t),n="https://request-proxy.herokuapp.com/?url=".concat(encodeURIComponent(e));return fetch(n,kt).then(Jt).catch(function(t){return console.error(t)})}var Pt={getClosestStop:At,getClosestStops:It,getDeparturesFrom:xt,getTrafficSituations:$t,findStops:Ct,init:function(){return Promise.resolve()}},Mt={TV:{track:"Spår",sname:"Anmärkn."},VT:{track:"Läge",sname:"Linje"},SL:{track:"Läge",sname:"Linje"}},Bt={VT:St,TV:it,SL:Pt},Ut=function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("aside",{class:[e.$style.journeyDetails,(t={},t[e.$style.display]=e.showJourneyDetails,t)]},[i("header",{class:e.$style.header},[i("h2",{class:e.$style.heading},[e._v("Detaljer")]),e.loadingJourneyDetails?i("font-awesome",{attrs:{icon:"spinner",spin:""}}):e._e(),i("button",{class:e.$style.closeBtn,on:{click:function(t){t.preventDefault(),e.setShowJourneyDetails(!1)}}},[e._v("✗")])],1),i("p",{class:e.$style.journeyMeta},[e.loadingJourneyDetails?e._e():i("span",[e._v("\n      "+e._s(e.journey.name)+" mot "+e._s(e.journey.direction)+"\n    ")]),i("a",{class:e.$style.mapLink,attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.setCurrentTab("Karta")}}},[e._v("Visa på karta")])]),e.loadingJourneyDetails?e._e():i("div",{class:e.$style.stopList},e._l(e.stops,function(t){return i("div",{key:t.depTime+t.name,class:[e.$style.stop,(n={},n[e.$style.stopPassed]=t.didPass,n)]},[i("div",{class:e.$style.stopDotCell},[i("div",{class:e.$style.stopDot})]),i("div",{class:e.$style.stopTime},[e._v("\n        "+e._s(t.rtDepTime||t.depTime)+"\n      ")]),i("div",{class:e.$style.stopName},[e._v(e._s(t.name))]),i("div",{class:e.$style.stopTrack},[e._v(e._s(t.track))])]);var n}))])},zt=[],Vt={name:"JourneyDetails",data:function(){return{now:Date.now(),timeoutId:null}},mounted:function(){var t=this;this.timeoutId=setInterval(function(){t.now=Date.now()},3e4)},beforeDestroy:function(){clearInterval(this.timeoutId)},computed:Object(u["a"])({},Object(l["e"])(["showJourneyDetails","loadingJourneyDetails","selectedJourney"]),{journey:function(){var t=this.selectedJourney;if(!t)return{};var e=[].concat(t.Direction);return{name:[].concat(t.JourneyName)[0].name,direction:e[e.length-1].$}},stops:function(){var t=this,e=this.selectedJourney;return e?e.Stop.map(function(e){var n=new Date("".concat(e.depDate,"T").concat(e.depTime)).getTime();return Object(u["a"])({},e,{didPass:n<t.now})}):[]}}),methods:Object(u["a"])({},Object(l["d"])(["setShowJourneyDetails"]),Object(l["d"])("tabs",["setCurrentTab"]))},Ht=Vt,qt=n("67f8");function Gt(t){this["$style"]=qt["default"].locals||qt["default"]}var Qt=Object(x["a"])(Ht,Ut,zt,!1,Gt,null,null);Qt.options.__file="JourneyDetails.vue";var Kt=Qt.exports,Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"location-input",class:{"with-label":t.label},on:{focus:t.showDropDown,keyup:function(e){return"button"in e||!t._k(e.keyCode,"esc",27,e.key,"Escape")?t.hideDropDown(e):null}}},[n("label",[t._v("\n    "+t._s(t.label)+":\n    "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],attrs:{disabled:t.disabled,type:"search",placeholder:""},domProps:{value:t.searchText},on:{input:[function(e){e.target.composing||(t.searchText=e.target.value)},t.onInput],focus:t.showDropDown,blur:t.possiblyHideDropDown,keyup:[function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.selectFirstSuggestion(e):null},t.handleKeyInput]}}),t.isLoading?n("font-awesome",{staticClass:"location-input__spinner",attrs:{icon:"spinner",spin:"","aria-hidden":"true"}}):t._e()],1),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"location-input__suggestions"},[t.showUseMyLocation?n("li",{staticClass:"location-input__suggestion",on:{keyup:t.handleKeyInput}},[n("button",{on:{click:function(e){return e.preventDefault(),t.getNearbyStops(e)}}},[n("font-awesome",{attrs:{icon:"crosshairs"}}),n("span",[t._v(" "+t._s(t.nearbyStopsMessage)+" ")]),t.isLoadingNearbyStops?n("font-awesome",{attrs:{icon:"spinner",spin:""}}):t._e()],1)]):t._e(),t._l(t.nearbyStops,function(e){return t.showNearbyStops?n("li",{key:e.name,staticClass:"location-input__suggestion",on:{keyup:t.handleKeyInput}},[n("button",{on:{click:function(n){n.preventDefault(),t.onSelect(e)},keyup:function(n){if(!("button"in n)&&t._k(n.keyCode,"space",32,n.key," "))return null;t.onSelect(e)}}},[t._v(t._s(e.name))])]):t._e()}),!t.searchText||t.stops.length||t.isLoading?t._e():n("li",{staticClass:"location-input__suggestion"},[n("button",{on:{click:function(t){t.preventDefault()}}},[t._v("Inga resultat för söktermen")])]),t._l(t.stops,function(e){return n("li",{key:e.id,staticClass:"location-input__suggestion",on:{keyup:t.handleKeyInput}},[n("button",{on:{click:function(n){n.preventDefault(),t.onSelect(e)},keyup:function(n){if(!("button"in n)&&t._k(n.keyCode,"space",32,n.key," "))return null;t.onSelect(e)}}},[t._v(t._s(e.name))])])})],2)])},Xt=[],Wt=(n("6762"),n("2fdb"),{name:"LocationInput",mounted:function(){this.selectedLocation&&(this.searchText=this.selectedLocation.name),this.debouncedFindStops=M(this.findStops,350,this)},props:{label:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{show:!1,searchText:""}},computed:Object(u["a"])({},Object(l["c"])("api",["api"]),Object(l["c"])({isLoadingNearbyStops:"user/isLoading"}),Object(l["e"])("user",["nearbyStops","nearbyStopsError"]),Object(l["e"])("stops",["stops","isLoading"]),Object(l["e"])({userLocation:function(t){var e=t.user;return e.location},selectedLocation:function(t){var e=t.trips;return e.location}}),{nearbyStopsMessage:function(){return this.isLoadingNearbyStops?"Hämtar närliggande hållplatser":this.nearbyStopsError||"Använd min plats"},showUseMyLocation:function(){return!this.searchText&&!this.nearbyStops.length},showNearbyStops:function(){return!this.searchText&&this.nearbyStops.length},hasSuggestions:function(){return this.stops.length||this.nearbyStops.length}}),watch:{selectedLocation:function(t){t||(this.searchText="")}},methods:Object(u["a"])({},Object(l["b"])("user",["getUserLocation","getNearbyStops"]),Object(l["b"])("stops",["findStops"]),Object(l["b"])("trips",["updateLocation"]),{onInput:function(t){var e=t.target.value;this.debouncedFindStops(e)},onSelect:function(t){this.searchText=t.name,this.updateLocation(t),this.hideDropDown(),this.findStops(t.name).then(this.hideDropDown)},selectFirstSuggestion:function(){0!==this.stops.length&&this.onSelect(this.stops[0])},handleKeyInput:function(t){var e={ArrowUp:"previousElementSibling",ArrowDown:"nextElementSibling"},n="button",i=function(n){return n.parentElement[e[t.key]]};if(["ArrowDown","ArrowUp"].includes(t.key)&&this.show&&this.hasSuggestions){var o=this.$el.querySelector(".location-input__suggestions ".concat(n,":focus"));if(o){var a=i(o);a&&a.querySelector(n).focus()}else this.$el.querySelector(".location-input__suggestions ".concat(n)).focus()}},showDropDown:function(){this.show=!0},hideDropDown:function(){this.show=!1,document.activeElement.blur()},possiblyHideDropDown:function(t){t.relatedTarget&&this.$el.contains(t.relatedTarget)||this.hideDropDown()}})}),Zt=Wt,te=(n("452a"),Object(x["a"])(Zt,Yt,Xt,!1,null,null,null));te.options.__file="LocationInput.vue";var ee,ne,ie=te.exports,oe=function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("div",{class:[e.$style.tripsTable,(t={},t[e.$style.VT]="VT"===e.apiName,t[e.$style.TV]="TV"===e.apiName,t[e.$style.SL]="SL"===e.apiName,t[e.$style.showingJourneyDetails]=e.showJourneyDetails,t)]},[i("table",{class:e.$style.table},[i("thead",{class:e.$style.tableHead},[i("tr",[i("th",[e._v(e._s(e.metaLabel))]),i("th",[e._v("Tid")]),i("th",[e._v(e._s(e.fromToLabel))]),i("th",{class:e.$style.tripNewTime},[e._v("Ny tid")]),i("th",[e._v(e._s(e.trackLabel))])])]),i("tbody",{class:e.$style.tableBody},[i("tr",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]},[i("td",{attrs:{colspan:"5"}},[e._v("\n          Hämtar trafikdata...\n          "),i("font-awesome",{attrs:{icon:"spinner",spin:""}})],1)]),e._l(e.trips,function(t){return i("tr",{key:t.id,class:[e.$style.trip,(n={},n[e.$style.cancelled]=t.cancelled,n)],on:{click:function(n){e.getJourneyDetails(t)}}},[i("td",{class:e.$style.tripLine,style:{backgroundColor:t.fgColor,color:t.bgColor}},[e._v("\n          "+e._s(t.sname)+"\n        ")]),i("td",{class:e.$style.tripTime},[i("span",{class:["only-mobile",(o={},o[e.$style.isLate]=t.isLate,o)]},[e._v(e._s(t.rtTime||t.time))]),i("span",{staticClass:"from-tablet"},[e._v(e._s(t.time))])]),i("td",{class:e.$style.tripDest},[i("div",[i("span",{class:e.$style.tripName},[e._v("\n              "+e._s(t.direction||t.origin)+"\n            ")]),t.isAffected?i("span",[e._v(" ⛔️")]):e._e(),t.cancelled?i("span",[e._v(" ⚠️ Färd inställd")]):e._e()]),i("div",{class:e.$style.tripVia},[t.via?i("small",[e._v(" via "+e._s(t.via))]):e._e()])]),i("td",{class:[e.$style.tripNewTime,e.$style.isLate]},[t.isLate?i("span",[e._v(e._s(t.rtTime))]):e._e()]),i("td",{class:e.$style.tripTrack},[e._v(e._s(t.track))])]);var n,o}),i("tr",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading&&e.location&&0===e.trips.length,expression:"!isLoading && location && trips.length === 0"}]},[i("td",{attrs:{colspan:"5"}},[e._v("Inga resor att visa")])])],2)])])},ae=[],re="speechSynthesis"in window;function se(){ee=window.speechSynthesis.getVoices(),ne=ee.find(function(t){var e=t.name;return"Alva"==e})}function ce(t){if(re){var e=new SpeechSynthesisUtterance;e.text=t,e.volume=1,e.rate=.9,e.pitch=1,ne?e.voice=ne:console.log("Could not select voice"),window.speechSynthesis.speak(e)}}re&&se(),window.speechSynthesis.onvoiceschanged=function(){se()};var ue={name:"TripsTable",props:{fromToLabel:{type:String,default:""}},mounted:function(){this.speak=M(this.speak,250,this)},computed:Object(u["a"])({},Object(l["e"])({showJourneyDetails:function(t){return t.showJourneyDetails},apiName:function(t){var e=t.api;return e.name}}),Object(l["e"])("trips",{isLoading:function(t){var e=t.isLoading;return e},location:function(t){var e=t.location;return e},doSpeak:function(t){var e=t.options;return e.voice}}),Object(l["c"])({trips:"trips/filteredTrips"}),Object(l["c"])("api",["dict"]),{metaLabel:function(){return this.dict.sname},trackLabel:function(){return this.dict.track}}),watch:{trips:function(t){this.speak(t)}},methods:Object(u["a"])({},Object(l["b"])(["getJourneyDetails"]),{speak:function(t){if(!(t.length<1)&&this.doSpeak){var e=t[0],n=e.name,i=e.direction,o=e.timestamp,a=t[0].via&&"via ".concat(t[0].via,",")||"",r=Math.ceil((o-Date.now())/6e4);ce(r<=0?"".concat(n," mot ").concat(i,", ").concat(a," avgår nu"):1===r?"".concat(n," mot ").concat(i,", ").concat(a," avgår om en minut"):r>1&&r<=60?"".concat(n," mot ").concat(i,", ").concat(a," avgår om ").concat(r," minuter"):"".concat(n," mot ").concat(i,", ").concat(a," avgår om mer än en timma"))}}})},le=ue,pe=n("55a3");function fe(t){this["$style"]=pe["default"].locals||pe["default"]}var de=Object(x["a"])(le,oe,ae,!1,fe,null,null);de.options.__file="TripsTable.vue";var me=de.exports,he=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.tripsFilter},[n("div",{class:t.$style.filter},[n("font-awesome",{staticClass:"only-mobile",attrs:{icon:"filter"}}),n("span",{staticClass:"from-tablet"},[t._v("Filter:")])],1),n("div",{class:t.$style.filter},[n("select",{attrs:{name:"dest"},on:{change:t.updateFilter}},[n("option",{attrs:{value:""}},[t._v(t._s(t.fromToLabel))]),t._l(t.destinations,function(e){return n("option",{key:e,domProps:{selected:t.filter.dest===e,value:e}},[t._v(t._s(e))])})],2)]),n("div",{class:t.$style.filter},[n("select",{attrs:{name:"track"},on:{change:t.updateFilter}},[n("option",{attrs:{value:""}},[t._v("Läge")]),t._l(t.tracks,function(e){return n("option",{key:e,domProps:{selected:t.filter.track===e,value:e}},[t._v(t._s(e))])})],2)]),n("div",{class:[t.$style.filter,"from-desktop"]},[n("label",[t._v("\n      Live\n      "),n("input",{attrs:{type:"checkbox",name:"isLive"},domProps:{checked:t.options.isLive},on:{input:t.updateOption}})])]),n("div",{class:t.$style.filter},[n("label",{class:t.$style.voice},[n("font-awesome",{attrs:{icon:["fas",t.options.voice?"volume-up":"volume-off"]}}),n("input",{class:t.$style.voiceCheckbox,attrs:{type:"checkbox",name:"voice"},domProps:{checked:t.options.voice},on:{input:t.updateOption}})],1)]),n("div",{class:t.$style.filter},[n("button",{class:t.$style.refreshBtn,attrs:{title:"Uppdatera"},on:{click:function(e){e.preventDefault(),t.getTrips()}}},[n("font-awesome",{attrs:{icon:"sync"}})],1)])])},ve=[];n("55dd"),n("4f7f"),n("c5f6");function ge(t,e){var n=Number(t)||t.charCodeAt(0),i=Number(e)||e.charCodeAt(0);return n<i?-1:n>i?1:0}var be=n("a322");function ye(t){if(!(t instanceof HTMLElement))throw Error("Argument must be HTMLElement");var e=t.nodeName,n=t.name;if("SELECT"===e)return Object(be["a"])({},n,t.selectedOptions[0].value);if("INPUT"===e){var i=["checkbox","radio"].includes(t.type)?t.checked:t.value;return Object(be["a"])({},n,i)}throw Error("Unhandled node type: ".concat(t.nodeName))}var Te={name:"TripsFilter",props:{dict:{type:Object,default:function(){return{}}}},data:function(){return{radio:!1,timeSpans:[{value:"30",name:"30 min"},{value:"60",name:"1 timme"},{value:"120",name:"2 timmar"},{value:"180",name:"3 timmar"},{value:"360",name:"6 timmar"},{value:"720",name:"12 timmar"},{value:"1440",name:"24 timmar"}]}},computed:Object(u["a"])({},Object(l["e"])("trips",["filter","options"]),Object(l["c"])({trips:"trips/filteredTrips"}),{fromToLabel:function(){return this.dict.origDest},arriveDepartLabel:function(){return this.dict.arrEaves},destinations:function(){return Array.from(new Set(this.trips.map(function(t){var e=t.direction,n=t.origin;return e||n})))},tracks:function(){var t=this.trips.map(function(t){var e=t.track;return e}).filter(function(t){return t}).map(String);return Array.from(new Set(t)).sort(ge)}}),methods:Object(u["a"])({},Object(l["d"])("trips",["setFilter","setOptions"]),Object(l["b"])("trips",["getTrips"]),{updateFilter:function(t){var e=t.target,n=ye(e);n&&this.setFilter(n)},updateOption:function(t){var e=t.target,n=ye(e);n&&this.setOptions(n)}})},_e=Te,Le=n("2f3b");function Se(t){this["$style"]=Le["default"].locals||Le["default"]}var De=Object(x["a"])(_e,he,ve,!1,Se,null,null);De.options.__file="TripsFilter.vue";var ke=De.exports,we={arrival:{arrEaves:"Ankommer",origDest:"Från"},departure:{arrEaves:"Avgår",origDest:"Till"}},je={name:"StationInfo",components:{LocationInput:ie,JourneyDetails:Kt,TripsTable:me,TripsFilter:ke},props:{arrivals:{type:Boolean,default:!1}},data:function(){return{manualTrips:[]}},computed:Object(u["a"])({},Object(l["e"])("trips",["location","situations"]),Object(l["e"])("api",{apiName:function(t){var e=t.name;return e},initializing:function(t){var e=t.initializing;return e}}),Object(l["c"])("api",["api"]),{dict:function(){return this.arrivals?we.arrival:we.departure},show:function(){return!!this.trips.length},fromToLabel:function(){return this.arrivals?"Från":"Till"},arriveDepartLabel:function(){return this.arrivals?"Ankommer":"Avgår"}}),watch:{arrivals:function(t,e){t!==e&&this.location&&this.getTrips(this.location)},apiName:function(t,e){t!==e&&(clearTimeout(this.lastTimeoutId),this.loadManualDepartures())}},mounted:function(){this.loadManualDepartures()},beforeDestroy:function(){clearTimeout(this.lastTimeoutId)},methods:Object(u["a"])({},Object(l["b"])("trips",["getTrips"]),{loadManualDepartures:function(){var t=this;"SOMETHING THAT DOES NOT EXIST"===this.apiName&&I.getManualDepartures().then(function(e){t.manualTrips=Bt.VT.transformTrips(e),console.log("this.manualTrips",t.manualTrips)})}})},Oe=je,Ie=n("aeaf");function Ae(t){this["$style"]=Ie["default"].locals||Ie["default"]}var Ce=Object(x["a"])(Oe,q,G,!1,Ae,null,null);Ce.options.__file="StationInfo.vue";var Ee=Ce.exports,Ne=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{class:t.$style.tabs},t._l(t.tabs,function(e){return n("li",{key:e.name,class:[t.$style.tab,(i={},i[t.$style.tabSmall]=e.small,i[t.$style.tabActive]=t.currentTab===e.name,i[t.$style.tabDisabled]=e.disabled,i)]},[n("a",{class:t.$style.link,attrs:{title:e.name,href:"#"},on:{click:function(t){t.preventDefault(),e.onClick(e.name,e.props.arrivals)}}},[e.icon?n("font-awesome",{class:t.$style.onlyMobile,attrs:{icon:e.icon}}):t._e(),e.initializing?t._e():n("span",{class:(o={},o[t.$style.onlyDesktop]=e.icon,o)},[t._v("\n        "+t._s(e.name)+"\n      ")]),e.initializing?n("font-awesome",{attrs:{icon:"spinner",spin:""}}):t._e()],1)]);var i,o}))},xe=[],$e={name:"TabsComponent",props:{tabs:{type:Array,default:function(){return[]}},onClick:{type:Function,default:function(){}},currentTab:{type:String,default:""}}},Je=$e,Re=n("6f5f");function Fe(t){this["$style"]=Re["default"].locals||Re["default"]}var Pe=Object(x["a"])(Je,Ne,xe,!1,Fe,null,null);Pe.options.__file="Tabs.vue";var Me=Pe.exports,Be={icon:"",props:{arrivals:!1},onClick:function(){}},Ue=[{name:"Avgångar",componentName:"station-info"},{name:"Ankomster",componentName:"station-info",props:{arrivals:!0}},{name:"Karta",componentName:"map-component",icon:"map"},{name:"Info",componentName:"information-page",icon:"info-circle"}],ze={name:"App",components:{MapComponent:function(){return n.e("chunk-4c1e").then(n.bind(null,"a0be"))},Tabs:Me,StationInfo:Ee,DigitalClock:H,InformationPage:R},computed:Object(u["a"])({},Object(l["e"])({apiName:function(t){var e=t.api;return e.name},initializing:function(t){var e=t.api;return e.initializing}}),Object(l["e"])("tabs",["currentTab"]),Object(l["c"])("api",["api"]),{tabs:function(){var t=this;return[Object(u["a"])({},Be,{name:this.apiName,small:!0,onClick:this.toggleApi,initializing:this.initializing})].concat(Object(c["a"])(Ue.map(function(e){return Object(u["a"])({},Be,e,{disabled:e.props&&e.props.arrivals&&"function"!==typeof t.api.getArrivalsTo,onClick:t.changeTab})})))},currentTabComponent:function(){var t=this;return this.tabs.find(function(e){var n=e.name;return n===t.currentTab})}}),methods:Object(u["a"])({},Object(l["d"])("trips",["setArrivals"]),Object(l["d"])("tabs",["setCurrentTab"]),Object(l["b"])("api",["toggleApi"]),{changeTab:function(t,e){this.setArrivals(e),this.setCurrentTab(t)}})},Ve=ze,He=(n("034f"),Object(x["a"])(Ve,r,s,!1,null,null,null));He.options.__file="App.vue";var qe=He.exports,Ge=n("e7ca"),Qe=n.n(Ge),Ke={isSupported:"geolocation"in navigator,isLoading:{location:!1,nearbyStops:!1},location:null,consented:null,nearbyStops:[],nearbyStopsError:""},Ye={isLoading:function(t){var e=t.isLoading;return e.location||e.nearbyStops}},Xe={getNearbyStops:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var n,i,o,a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,i=e.dispatch,o=e.state,a=e.rootState,r=e.rootGetters,o.isSupported){t.next=3;break}return t.abrupt("return");case 3:if(o.location){t.next=6;break}return t.next=6,i("getUserLocation");case 6:n("setLoading",{nearbyStops:!0}),r["api/api"].getClosestStops(o.location).then(function(t){console.log("nearbySyops",t),t&&t.length&&t[0].region===a.api.name?n("setNearbyStops",t):(n("setNearbyStopsError","Hittade ingen närliggande hållplats 😥"),setTimeout(function(){return n("setNearbyStopsError","")},7e3)),n("setLoading",{nearbyStops:!1})}).catch(function(t){console.error(t),n("setLoading",{nearbyStops:!1}),n("setNearbyStopsError","Något gick snett 😱")});case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getUserLocation:function(t){var e=t.commit,n=t.state;return n.isSupported?(e("setLoading",{location:!0}),new Promise(function(t,e){navigator.geolocation.getCurrentPosition(t,e)}).then(function(t){e("setLoading",{location:!1}),e("setConsented",!0),e("setLocation",t.coords)}).catch(function(t){console.error(t),e("setLoading",{location:!1}),e("setConsented",!1)})):Promise.resolve()}},We={setLoading:function(t,e){t.isLoading=Object(u["a"])({},t.loading,e)},setConsented:function(t,e){t.consented=e},setLocation:function(t,e){t.location={lat:e.latitude,lng:e.longitude}},setNearbyStops:function(t,e){t.nearbyStops=e,t.nearbyStopsError=""},setNearbyStopsError:function(t,e){t.nearbyStopsError=e}},Ze={namespaced:!0,state:Ke,getters:Ye,actions:Xe,mutations:We},tn=(n("456d"),n("9393")),en=/\s*via\s*/;function nn(t){if(en.test(t.direction)){var e=t.direction.split(en),n=Object(tn["a"])(e,2),i=n[0],o=n[1];return Object.assign({},t,{direction:i,via:o})}return t}var on,an={track:"",dest:"",timeSpan:""},rn={messages:[],affectedLines:[]},sn={isLive:!0,voice:!1},cn=Object.keys(an),un=Object.keys(sn),ln={arrivals:!1,filter:Object(u["a"])({},an),options:Object(u["a"])({},sn),trips:[],situations:Object(u["a"])({},rn),isLoading:!1,location:null},pn={filteredTrips:function(t){var e=t.trips,n=t.filter,i=t.situations,o=n.track,a=n.dest,r=i.affectedLines,s=void 0===r?[]:r;return e.map(function(t){return Object(u["a"])({},t,{isAffected:s.includes(t.sname)})}).filter(function(t){return!o||t.track===o}).filter(function(t){var e=t.direction,n=t.origin;return!a||(e===a||n===a)}).sort(function(t,e){return t.timestamp-e.timestamp})}},fn={getTrips:function(t){var e=t.commit,n=t.state,i=t.rootGetters,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.location,a=n.arrivals?i["api/api"]["getArrivalsTo"]:i["api/api"]["getDeparturesFrom"];return e("setLoading",!0),a(o.id,n.filter.timeSpan).then(function(t){var n=t.map(nn);console.log("[getTrips]",n),e("setTrips",n),e("setLoading",!1)}).catch(function(t){console.error("[getTrips]",t),e("setLoading",!1)})},getTrafficSituations:function(t,e){var n=t.commit,i=t.rootGetters;return i["api/api"].getTrafficSituations(e.id,"stoparea").then(function(t){console.log("situations",t),n("setSituations",t)}).catch(function(t){return console.error("[getTrafficSituations]",t)})},updateLocation:function(t,e){var n=t.dispatch,i=t.commit,o=t.state;o.location!==e&&(console.log("[updateLocation]",e),i("setLocation",e),n("getTrips",e),n("getTrafficSituations",e))}},dn={reset:function(t){t.trips=[],t.filter=Object(u["a"])({},an),t.location=null,t.situations=Object(u["a"])({},rn)},setFilter:function(t,e){if(!Object.keys(e).every(function(t){return cn.includes(t)}))return console.error("[setFilter]","Non valid key(s) supplied, must be one of",cn);t.filter=Object(u["a"])({},t.filter,e)},setOptions:function(t,e){if(!Object.keys(e).every(function(t){return un.includes(t)}))return console.error("[setOptions]","Non valid key(s) supplied, must be one of",un);t.options=Object(u["a"])({},t.options,e)},setTrips:function(t,e){t.trips=e},setSituations:function(t,e){t.situations=e},setLoading:function(t,e){t.isLoading=e},setLocation:function(t,e){t.location=e},setArrivals:function(t,e){t.arrivals=e}},mn={namespaced:!0,state:ln,getters:pn,actions:fn,mutations:dn},hn={stops:[],isLoading:!1},vn={},gn={findStops:function(t,e){var n=t.commit,i=t.rootGetters;return e?(on=e,n("setLoading",!0),i["api/api"].findStops(e).then(function(t){return console.log("stops",t),on===e?(n("setLoading",!1),n("setStops",t)):console.log("skipping response"),t}).catch(function(t){console.error(t),n("setLoading",!1)})):n("setStops",[])}},bn={setStops:function(t,e){t.stops=e},setLoading:function(t,e){t.isLoading=e}},yn={namespaced:!0,state:hn,getters:vn,actions:gn,mutations:bn},Tn={currentTab:"Avgångar"},_n={setCurrentTab:function(t,e){t.currentTab=e}},Ln={namespaced:!0,state:Tn,mutations:_n},Sn=Object.keys(Bt),Dn="VT";if(!Sn.includes(Dn))throw new Error("defaultApi must exist");var kn=[],wn={name:Dn,initializing:!0},jn={api:function(t){var e=t.name;return Bt[e]},dict:function(t){var e=t.name;return Mt[e]}},On={setApi:function(t,e){t.name=e},setInitializing:function(t,e){t.initializing=e}},In={initApi:function(t){var e=t.commit,n=t.state;console.info("initializing",n.name),e("setInitializing",!0),Bt[n.name].init().then(function(){e("setInitializing",!1),kn.push(n.name)}).catch(function(t){console.error("[initApi]",t),e("setInitializing",!1)})},toggleApi:function(t){var e=t.state,n=t.commit,i=t.dispatch,o=Sn.indexOf(e.name),a=(o+1)%Sn.length,r=Sn[a],s=kn.includes(r);n("setApi",r),n("trips/reset",null,{root:!0}),n("stops/setStops",[],{root:!0}),s||i("initApi")}},An={namespaced:!0,state:wn,getters:jn,mutations:On,actions:In};a["a"].use(l["a"]);var Cn=new Qe.a({storage:window.localStorage,reducer:function(t){return{trips:t.trips,api:t.api}}}),En=new l["a"].Store({strict:!1,state:{selectedJourney:null,showJourneyDetails:!1,loadingJourneyDetails:!1},getters:{},mutations:{selectJourney:function(t,e){t.selectedJourney=e},setShowJourneyDetails:function(t,e){t.showJourneyDetails=e},setLoadingJourneyDetails:function(t,e){t.loadingJourneyDetails=e}},actions:{getJourneyDetails:function(t,e){var n=t.commit,i=t.state;if("VT"!==i.api.name||!e.JourneyDetailRef)return console.log("[getJourneyDetails]","only available for VT"),Promise.resolve();n("setShowJourneyDetails",!0),n("setLoadingJourneyDetails",!0),Bt.VT.getJourneyDetail(e.JourneyDetailRef.ref).then(function(t){n("selectJourney",t),n("setLoadingJourneyDetails",!1)}).catch(function(t){console.error("[getJourneyDetails]",t),n("setLoadingJourneyDetails",!1)})}},modules:{api:An,user:Ze,trips:mn,stops:yn,tabs:Ln},plugins:[Cn.plugin]}),Nn=n("9483");Object(Nn["a"])("".concat("/rasmus2.0/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var xn=n("ecee"),$n=n("c074"),Jn=n("7a55");xn["library"].add($n["e"],$n["g"],$n["a"],$n["c"],$n["f"],$n["i"],$n["h"],$n["d"],$n["b"]),a["a"].component("font-awesome",Jn["FontAwesomeIcon"]),a["a"].config.productionTip=!1,En.dispatch("api/initApi"),new a["a"]({store:En,render:function(t){return t(qe)}}).$mount("#app")},"67f8":function(t,e,n){"use strict";var i=n("add9"),o=n.n(i);e["default"]=o.a},"68f3":function(t,e,n){t.exports={informationPage:"InformationPage_informationPage_2JzFC",editLink:"InformationPage_editLink_3mh2I",spinner:"InformationPage_spinner_3mv-F"}},"6f5f":function(t,e,n){"use strict";var i=n("9dcf"),o=n.n(i);e["default"]=o.a},"979c":function(t,e,n){"use strict";var i=n("68f3"),o=n.n(i);e["default"]=o.a},"9dcf":function(t,e,n){t.exports={tabs:"Tabs_tabs_1QR2X",tab:"Tabs_tab_15Faw",tabSmall:"Tabs_tabSmall_3oxul",tabActive:"Tabs_tabActive_5B2qN",tabApi:"Tabs_tabApi_1DbIs",tabDisabled:"Tabs_tabDisabled_2LyC1",link:"Tabs_link_3QSdo",onlyDesktop:"Tabs_onlyDesktop_2idts",onlyMobile:"Tabs_onlyMobile_33MVU"}},"9ec4":function(t,e,n){},aa4e:function(t,e,n){t.exports={stationInfo:"StationInfo_stationInfo_1Dt3D",form:"StationInfo_form_3BKgO",content:"StationInfo_content_3LXMa",situations:"StationInfo_situations_nDEmL"}},add9:function(t,e,n){t.exports={journeyDetails:"JourneyDetails_journeyDetails_3YAJj",display:"JourneyDetails_display_nRo1Q",header:"JourneyDetails_header_2FVDd",heading:"JourneyDetails_heading_1u5lY",closeBtn:"JourneyDetails_closeBtn_2AamI",journeyMeta:"JourneyDetails_journeyMeta_2_eYX",mapLink:"JourneyDetails_mapLink_1boUP",stopList:"JourneyDetails_stopList_2AU0a",stop:"JourneyDetails_stop_1ijip",stopDotCell:"JourneyDetails_stopDotCell_1gJ_N",stopDot:"JourneyDetails_stopDot_-Ig6N",stopPassed:"JourneyDetails_stopPassed_3heFC",stopTime:"JourneyDetails_stopTime_SRZYM",stopName:"JourneyDetails_stopName_1ry27",stopTrack:"JourneyDetails_stopTrack_1BnIw"}},aeaf:function(t,e,n){"use strict";var i=n("aa4e"),o=n.n(i);e["default"]=o.a},b679:function(t,e,n){t.exports={tripsFilter:"TripsFilter_tripsFilter_ZISik",filter:"TripsFilter_filter_1W5CS",voice:"TripsFilter_voice_3SGKu",voiceCheckbox:"TripsFilter_voiceCheckbox_2LW6X",refreshBtn:"TripsFilter_refreshBtn_YozBh"}},c21b:function(t,e,n){}});
//# sourceMappingURL=app-legacy.4a04eb91.js.map